{"title":"Tools for genome annotations","markdown":{"headingText":"Tools for genome annotations","containsRefs":false,"markdown":"\n## Hmmsearch\n\n### Basics\n\nhmmsearch  is  used  to  search  one or more profiles against a sequence database.  For each profile in <hmmfile>, use that query profile to search the target database of sequences in <seqdb>, and output ranked lists of the sequences with the most significant matches to the profile. \n\n- -o <f> Direct the main human-readable output to a file <f> instead of the default stdout. **Careful, file becomes large**\n- --tblout: Save a simple tabular (space-delimited) file summarizing the per-target output, with one data line  per  homologous target sequence found.\n- --domtblout <f>Save a simple tabular (space-delimited) file summarizing the per-domain output, with one data line per homologousdomain detected in a query sequence for each homologous model.\n\nAvailable databases: \n\n- /export/lv1/user/spang_team/Databases/arCOGs2019/All_Arcogs_2018.hmm\n\n```{bash}\n#example usage for an acrog search\nhmmsearch --tblout output/sequence_results.txt -o output/results_all.txt --domtblout output/domain_results.txt --notextw --cpu 100 /export/lv1/user/spang_team/Databases/arCOGs2019/All_Arcogs_2018.hmm Genomes.faa\n```\n\n### Parsing the output\n\n```{bash}\n#format the full table and only select sequences above a certain evalue\nsed 's/ \\+ /\\t/g' output/sequence_results.txt | sed '/^#/d'| sed 's/ /\\t/g'| awk -F'\\t' -v OFS='\\t' '{print $1, $3, $6, $5}' | awk -F'\\t' -v OFS='\\t' '($4 + 0) <= 1E-3'  > output/sequence_results_red_e_cutoff.txt\n\n#get best hit based on bit score, and then evalue\nsort -t$'\\t' -k3,3gr -k4,4g KOs_hmmer_raw/sequence_results_red_e_cutoff.txt | sort -t$'\\t' --stable -u -k1,1  | sort -t$'\\t' -k3,3gr -k4,4g >  KOs_hmmer_raw/All_KO_hmm.txt\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Annotating_genomes.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.168","bibliography":["references.bib"],"knitr":{"opts_chunk":{"collapse":true}},"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"github","output-file":"Annotating_genomes.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["references.bib"],"knitr":{"opts_chunk":{"collapse":true}},"documentclass":"scrreprt","geometry":["top=4mm","left=4mm","heightrounded"],"fontfamily":"libertinus","pandoc_args":"--listings","includes":{"in_header":"preamble.tex"},"colorlinks":true},"extensions":{"book":{}}}}}